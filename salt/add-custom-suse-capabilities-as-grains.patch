From d8d09399159b84d9aa3863c7d1bcb16bdeceaee4 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Pablo=20Su=C3=A1rez=20Hern=C3=A1ndez?=
 <psuarezhernandez@suse.com>
Date: Thu, 21 Jun 2018 11:57:57 +0100
Subject: [PATCH] Add custom SUSE capabilities as Grains

---
 salt/_suse_backported_capabilities.py | 10 ++++++++++
 salt/grains/extra.py                  | 14 ++++++++++++++
 2 files changed, 24 insertions(+)
 create mode 100644 salt/_suse_backported_capabilities.py

diff --git a/salt/_suse_backported_capabilities.py b/salt/_suse_backported_capabilities.py
new file mode 100644
index 0000000000..ecc1456807
--- /dev/null
+++ b/salt/_suse_backported_capabilities.py
@@ -0,0 +1,10 @@
+#-*- coding: utf-8 -*-
+'''
+    Definition of SUSE backported Salt capabilities
+    (This file is SUSE reserved. Please do not edit)
+'''
+
+backported_capabilities = [
+    'PKG_PATCHES_SUPPORT',
+    'PKG_ALLVERSIONS_SUPPORT',
+]
diff --git a/salt/grains/extra.py b/salt/grains/extra.py
index 228446675b..2b75364539 100644
--- a/salt/grains/extra.py
+++ b/salt/grains/extra.py
@@ -12,6 +12,12 @@ import logging
 # Import salt libs
 import salt.utils
 
+try:
+    from salt import _suse_backported_capabilities
+    HAS_SUSE_CAPABILITIES = True
+except ImportError:
+    HAS_SUSE_CAPABILITIES = False
+
 log = logging.getLogger(__name__)
 
 
@@ -48,3 +54,11 @@ def config():
                 log.warning("Bad syntax in grains file! Skipping.")
                 return {}
     return {}
+
+
+def suse_backported_capabilities():
+    if HAS_SUSE_CAPABILITIES:
+        return {
+            '__suse_backported_capabilities':
+                _suse_backported_capabilities.backported_capabilities
+        }
-- 
2.17.1


